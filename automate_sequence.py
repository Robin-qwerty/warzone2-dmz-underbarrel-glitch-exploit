import pyautogui
import time
import keyboard
import mouse

pyautogui.PAUSE = 0  # Disable pyautogui's built-in delay

def execute_sequence():
    try:
        # Press 'v' and hold
        keyboard.press('v')
        time.sleep(0.013)  # 13 ms

        # Press left mouse button and hold
        pyautogui.mouseDown()
        time.sleep(0.014)  # 14 ms

        # Press 'q' and hold
        keyboard.press('q')
        time.sleep(0.025)  # 25 ms

        # Release left mouse button
        pyautogui.mouseUp()
        time.sleep(0.025)  # 25 ms

        # Press '1' and hold
        keyboard.press('1')
        time.sleep(0.014)  # 14 ms

        # Release 'v'
        keyboard.release('v')
        time.sleep(0.013)  # 13 ms

        # Press and release left mouse button
        pyautogui.click()
        time.sleep(0.014)  # 14 ms

        # Release 'q'
        keyboard.release('q')
        time.sleep(0.025)  # 25 ms

        # Release '1'
        keyboard.release('1')

        print("Sequence executed.")
    except Exception as e:
        print(f"An error occurred: {e}")

if __name__ == "__main__":
    print("Press Mouse Button 5 to start the sequence...")

    # Set up a mouse button hotkey to trigger the sequence
    mouse.on_middle_click(execute_sequence)

    # Keep the program running to listen for the hotkey
    print("Press ESC to exit.")
    keyboard.wait('esc')
