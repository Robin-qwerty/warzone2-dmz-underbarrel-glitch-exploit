import pyautogui
import time
import keyboard
import mouse

pyautogui.PAUSE = 0  # Disable pyautogui's built-in delay

# Global variable to track the active state of the script
active = False

def toggle_active():
    global active
    active = not active
    state = "active" if active else "inactive"
    print(f"Script is now {state}")

def execute_sequence():
    if active:
        try:
            # Press 'v' and hold
            keyboard.press('v')
            time.sleep(0.013)  # 13 ms

            # Press left mouse button and hold
            pyautogui.mouseDown()
            time.sleep(0.014)  # 14 ms

            # Press 'q' and hold
            keyboard.press('q')
            time.sleep(0.025)  # 25 ms

            # Release left mouse button
            pyautogui.mouseUp()
            time.sleep(0.025)  # 25 ms

            # Press '1' and hold
            keyboard.press('1')
            time.sleep(0.014)  # 14 ms

            # Release 'v'
            keyboard.release('v')
            time.sleep(0.013)  # 13 ms

            # Press and release left mouse button
            pyautogui.click()
            time.sleep(0.014)  # 14 ms

            # Release 'q'
            keyboard.release('q')
            time.sleep(0.025)  # 25 ms

            # Release '1'
            keyboard.release('1')

            print("Sequence executed.")
        except Exception as e:
            print(f"An error occurred: {e}")

if __name__ == "__main__":
    print("Press middle Mouse Button to start the sequence...")
    print("Press DEL to activate/deactivate the script...")
    print("Press CTRL+C to exit.")

    # Set up the mouse button hotkey to trigger the sequence
    mouse.on_middle_click(execute_sequence)

    # Set up a keyboard hotkey to toggle the active state
    keyboard.add_hotkey('del', toggle_active)

    try:
        # Keep the program running to listen for the hotkey
        while True:
            time.sleep(0.1)  # Small delay to prevent high CPU usage
    except KeyboardInterrupt:
        print("Exiting the script.")
